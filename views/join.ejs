<!DOCTYPE html>
<html>

<head>
    <% include common/meta.ejs %>
    <% include common/css.ejs %>

    <title>Tichu Online - 회원 가입</title>
    <!-- Custom style -->
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/login.css">
</head>

<body>
<div class="login-wrapper container">
    <div class="row">
        <div class="col-lg-12">
            <div class="text-center">
                <h1><a href="/">Tichu Online</a></h1>
            </div>
        </div>

        <div class="col-lg-offset-4 col-lg-4 col-xs-offset-2 col-xs-8">

            <% if (message.length > 0) { %>
            <div class="alert alert-warning alert-dismissable fade in">
                <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                <p class="text-center"><%= message %></p>
            </div>
            <% } %>

            <form action="/join" method="POST">
                <div id="email-form-group" class="form-group has-feedback">
                    <label for="email">Email</label>
                    <input id="email" type="email" class="form-control" name="email" onchange="onChange()">
                    <span id="email-feedback" class="glyphicon form-control-feedback" aria-hidden="true"></span>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input id="password" type="password" class="form-control" name="password">
                </div>
                <div class="form-group">
                    <label for="password-check">Check Password</label>
                    <input id="password-check" type="password" class="form-control" name="password-check">
                </div>
                <button type="submit" class="btn btn-borderless btn-block">회원 가입</button>
            </form>

            <a href="/login" class="btn btn-borderless btn-block">이미 아이디가 있으신가요?</a>
        </div>
    </div>
</div>

<footer>
    <div class="container">
        <p class="text-center">Made by Illisia.</p>
    </div>
</footer>

<% include common/js.ejs %>
<script>
    function onChange() {
        var email = $('#email').val();

        $.get("/join/find/" + email, function (data, status) {
            if (data) {
                var $emailFormGroup = $('#email-form-group');
                var $emailFeedback = $('#email-feedback');

                if (data.exists) {
                    $emailFormGroup.removeClass('has-success');
                    $emailFeedback.removeClass('glyphicon-ok');

                    $emailFormGroup.addClass('has-error');
                    $emailFeedback.addClass('glyphicon-remove');
                } else {
                    $emailFormGroup.removeClass('has-error');
                    $emailFeedback.removeClass('glyphicon-remove');

                    $emailFormGroup.addClass('has-success');
                    $emailFeedback.addClass('glyphicon-ok');
                }
            }
        });
    }
</script>
</body>

</html>